package com.example.audioplayer;

import javafx.collections.FXCollections;
import javafx.scene.control.ListView;
import javafx.scene.media.MediaPlayer;
import org.junit.Test;
import vinnsla.Lag;
import vinnsla.Lagalisti;

import static org.junit.jupiter.api.Assertions.*;
import static org.mockito.Mockito.*;

public class ListiControllerTest {
    private MediaPlayer player;
    private ListView<Lag> listView;
    private ListiController controller;


    public void setUp() {
        player = mock(MediaPlayer.class);
        listView = mock(ListView.class);
        controller = new ListiController();
        controller.setMediaPlayer(player);
        controller.setListView(listView);
    }

    @Test
    public void whenSetValinnListi_thenListShouldBeUpdated() {
        // Arrange
        Lagalisti lagalisti = mock(Lagalisti.class);
        when(lagalisti.getListi()).thenReturn(FXCollections.observableArrayList(new Lag("TestSong", "test.mp3")));

        // Act
        controller.setValinnListi(lagalisti);

        // Assert
        verify(listView).setItems(any());
    }

    @Test
    public void whenSongEnds_thenNextSongShouldPlay() {
        // Arrange
        when(listView.getItems()).thenReturn(FXCollections.observableArrayList(
                new Lag("Song1", "song1.mp3"),
                new Lag("Song2", "song2.mp3")
        ));
        when(listView.getSelectionModel().getSelectedIndex()).thenReturn(0);

        // Act
        controller.naestaLag();

        // Assert
        verify(listView.getSelectionModel()).select(1);
        verify(player).play();
    }

    public static void main(String[] args) {

    }
}
